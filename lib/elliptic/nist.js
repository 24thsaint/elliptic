var nist = exports;

var assert = require('assert');
var elliptic = require('../elliptic');

function NISTCurve(options) {
  this.curve = new elliptic.curve(options);
  this.g = this.curve.pointFromJSON(options.g);
  this.n = new elliptic.bn(options.n, 16);
  this.h = new elliptic.bn(options.h, 16);

  assert(this.g.validate(), 'Invalid NIST curve');
  assert(this.g.mul(this.n).isInfinity(), 'Invalid NIST curve, G*N != O');
}
nist.NISTCurve = NISTCurve;

function defineCurve(name, options) {
  Object.defineProperty(nist, name, {
    configurable: true,
    enumerable: true,
    get: function() {
      var curve = new NISTCurve(options);
      Object.defineProperty(nist, name, {
        configurable: true,
        enumerable: true,
        value: curve
      });
      return curve;
    }
  });
}

defineCurve('secp256k1', {
  p: 'ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f',
  a: '0',
  b: '7',
  n: 'ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141',
  h: '1',

  // Point and precomputed 2^N powers of it
  g: [
    '79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798',
    '483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8',
    [
      [
        'c6047f9441ed7d6d3045406e95c07cd85c778e4b8cef3ca7abac09b95c709ee5',
        '1ae168fea63dc339a3c58419466ceaeef7f632653266d0e1236431a950cfe52a'
      ],
      [
        'e493dbf1c10d80f3581e4904930b1404cc6c13900ee0758474fa94abe8c4cd13',
        '51ed993ea0d455b75642e2098ea51448d967ae33bfbdfe40cfe97bdc47739922'
      ],
      [
        '2f01e5e15cca351daff3843fb70f3c2f0a1bdd05e5af888a67784ef3e10a2a01',
        '5c4da8a741539949293d082a132d13b4c2e213d6ba5b7617b5da2cb76cbde904'
      ],
      [
        'e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a',
        'f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821'
      ],
      [
        'd30199d74fb5a22d47b6e054e2f378cedacffcb89904a61d75d0dbd407143e65',
        '95038d9d0ae3d5c3b3d6dec9e98380651f760cc364ed819605b3ff1f24106ab9'
      ],
      [
        'bf23c1542d16eab70b1051eaf832823cfc4c6f1dcdbafd81e37918e6f874ef8b',
        '5cb3866fc33003737ad928a0ba5392e4c522fc54811e2f784dc37efe66831d9f'
      ],
      [
        '34ff3be4033f7a06696c3d09f7d1671cbcf55cd700535655647077456769a24e',
        '5d9d11623a236c553f6619d89832098c55df16c3e8f8b6818491067a73cc2f1a'
      ],
      [
        '8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508',
        '11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf'
      ],
      [
        '465370b287a79ff3905a857a9cf918d50adbc968d9e159d0926e2c00ef34a24d',
        '35e531b38368c082a4af8bdafdeec2c1588e09b215d37a10a2f8fb20b33887f4'
      ],
      [
        '241febb8e23cbd77d664a18f66ad6240aaec6ecdc813b088d5b901b2e285131f',
        '513378d9ff94f8d3d6c420bd13981df8cd50fd0fbd0cb5afabb3e66f2750026d'
      ],
      [
        '5d1bdb4ea172fa79fce4cc2983d8f8d9fc318b85f423de0dedcb63069b920471',
        '2843826779379e2e794bb99438a2265679eb1e9996c56e7b70330666f7b83103'
      ],
      [
        '175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739',
        'd3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695'
      ],
      [
        '423a013f03ff32d7a5ffbcc8e139c62130fdfeb5c6da121bce78049e46bc47d6',
        'b91ae00fe1e1d970a1179f7bbaf6b3c7720d8ec3524f009ed1236e6d8b548a34'
      ],
      [
        '111d6a45ac1fb90508907a7abcd6877649df662f3b3e2741302df6f78416824a',
        '696911c478eaffbb90d48dbff065952f070008996daca4ca9a111d42108e9d0'
      ],
      [
        '4a4a6dc97ac7c8b8ad795dbebcb9dcff7290b68a5ef74e56ab5edde01bced775',
        '529911b016631e72943ef9f739c0f4571de90cdb424742acb2bf8f68a78dd66d'
      ],
      [
        '363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640',
        '4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9'
      ],
      [
        '4c1b9866ed9a7e9b553973c6c93b02bf0b62fb012edfb59dd2712a5caf92c541',
        'c1f792d320be8a0f7fbcb753ce56e69cc652ead7e43eb1ad72c4f3fdc68fe020'
      ],
      [
        'a4083877ba83b12b529a2f3c0780b54e3233edbc1a28f135e0c8f28cbeaaf3d1',
        '40e9f612feefbc79b8bf83d69361b3e22001e7576ed1ef90b12b534df0b254b9'
      ],
      [
        'a804c641d28cc0b53a4e3e1a2f56c86f6e0d880a454203b98cd3db5a7940d33a',
        '95be83252b2fa6d03dec2842c16047e81af18ca89cf736a943ce95fa6d46967a'
      ],
      [
        '8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c',
        '4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36'
      ],
      [
        'ed0c5ce4e13291718ce17c7ec83c611071af64ee417c997abb3f26714755e4be',
        '221a9fc7bc2345bdbf3dad7f5a7ea68049d93925763ddab163f9fa6ea07bf42f'
      ],
      [
        'faecb013c44ce694b3b15c3f83f1fae8e53254566e0552ced4b6e6c807cec8ab',
        'cc09b5e90e9ecb57fc2e02c6ec2fb13d9c32b286b85e2e2e8981dfd9ab155070'
      ],
      [
        '9bb8a132dcad2f2c8731a0b37cbcafdb3b2dd824f23cd3e07f64eae9ad1b1f7',
        '945bb2b2afeee3b9b6f9dd284f863e850f54a840f4752d5364130627c3811c80'
      ],
      [
        '723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda',
        '96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f'
      ],
      [
        '57efa786437b744d343d7dc45773a3c62d240a43079849071fd383d60ca030d5',
        'd712db0bd1b48518893627c928de03ec689b6d2ae5e9974ab07ab44274b02f9e'
      ],
      [
        '264bbd436a28bc42a2df7e9cd5226cb91080577e327b012a7fafc7770c584dd5',
        'd87c6fa94ee093b4d4f75ce24c33be226a118243717b8d8de61227937704ab11'
      ],
      [
        'a94c6524bd40d2bbdac85c056236a79da78bc61fd5bdec9d2bf26bd84b2438e8',
        'b5201fd992f96280fd79219505019e3a7e5d3c60a0e39b2bc2e2c8dbf18661f4'
      ],
      [
        'eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa',
        '5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999'
      ],
      [
        '381c4ad7a7a97bfda61c6031c118495fc4ea4bc08f6766d676bee90847d297fd',
        '936af53b238eeee48f3e5fa709915eccf0451032db939c0093ace3187d493fc5'
      ],
      [
        'e1efb9cd05adc63bcce10831d9538c479cf1d05fefdd08b2448d70422ede454c',
        'ecb4530d8af9be7b0154c1ffe477123464e3244a7a2d4c6ad9fd233a8913797'
      ],
      [
        '5318f9b1a2697010c5ac235e9af475a8c7e5419f33d47b18d33feeb329eb99a4',
        'f44ccfeb4beda4195772d93aebb405e8a41f2b40d1e3ec652c726eeefe91f92d'
      ],
      [
        '100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0',
        'cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09'
      ],
      [
        '8c0989f2ceb5c771a8415dff2b4c4199d8d9c8f9237d08084b05284f1e4df706',
        'fb4dbd044f432034ffd2172cb9dc966c60de6bf5156511aa736ac5a35d72fa98'
      ],
      [
        'fb8f153c5e266704c4a481743262c0259c528539bc95bc1bb1e63c33dc47bffd',
        '6ca27a9dc5e0621816fa11d9b4bccd531dde1389ac542613090a45ddd949b095'
      ],
      [
        'e747333fd75d51755a0cc9f0a728708465a02c587737a7b8b8fa1b8b4bb2629a',
        'f2affe0145070c114cc43603804c2581c88376aa6e1a969a9f8d961a6946f6d6'
      ],
      [
        'e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d',
        '9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d'
      ],
      [
        'f4b93f224c8089eab9f95dcd0f29b2c9028a6ac5de94d85784e27e36a95c8356',
        'a67a92ec062962dfb0e5f6a7a40eee90c37ef1344915609abd5861b9be001fd3'
      ],
      [
        '9d1aca1fce55236b19622ea025b08b0d51e8512f97e696c20d62fe17b160e8a',
        '1153188f5101f0c63e56692ce0d8c27e6fe9e0ee9212b5e534e050c57ca04c44'
      ],
      [
        'c66c59cc454c2b9e18a2ad793821cde7518b3a93bfc39562e97d7d0475ba7fc2',
        'd9592fe2bfb30fcfbea4f3ceaac10cb2f00a60ddb15955977ec3c69cf75f5956'
      ],
      [
        'feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d',
        'e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088'
      ],
      [
        '4d000b621adb87e1c53261af9db2e179141ecae0b331a1870aa4040aee752b08',
        '6a0d5b8f18e0d255cb6d825582d972cccb7df5f119c7293a3e72851f48302cea'
      ],
      [
        '71f570ca203da05dd6aa262114717128d657a0403e1f1b77f89962fd475c58ef',
        'eb42415b95dc880dd25557345bc95b8df2445d00c3363e7df8649a72d35d420e'
      ],
      [
        'a2b7b3629f7bd253b7d282b5c21da01446b4821dc65e76516048b06043ff8359',
        '693038941695122d57a937a3f71e29c910d10835046f3835a2397fecfe86fec2'
      ],
      [
        'da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1',
        '9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d'
      ],
      [
        '4dbacd365fa1ef587c0c0cfaaf00d8718bbd9f35ccea5a835ee3cc821fe741c9',
        '16c3540e8a51892e7fdcfd59e838299d0cc384a09fc0535f60be10f8338eb623'
      ],
      [
        '13d1ffc481509beee68f17d8ff41c2590f4c85f15268605087eda8bab4e218da',
        '6008391fa991961dcecb9337b1b758bda4ad01206d5bd127e0db419ddb191c19'
      ],
      [
        '219b4f9cef6c60007659c79c45b0533b3cc9d916ce29dbff133b40caa2e96db8',
        '24d9c605d959efeaf5a44180c0372a6e394f8ac53e90576527df01a78d3b6bc7'
      ],
      [
        '53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0',
        '5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8'
      ],
      [
        '1a575af9d4146753cf991196316995d2a6ee7aaad0f85ad57cd0f1f38a47ca9',
        '3038f1cb8ab20dc3cc55fc52e1bb8698bdb93c5d9f4d7ea667c5df2e77ebcdb7'
      ],
      [
        'f5f0e0437621d439ca71f5c1b76155d6d3a61a83d3c20c6ee309d755e315565b',
        '6b9f4e62be5a052bf62189160df7101aa5bf61bf3ed7e40a678430afdd2ecc82'
      ],
      [
        '8f506f0b6c0b6e9a57a7f36d970ca4e347cbc92146227642cbe781d9f5362d33',
        '469f955d2afa61719530c5424f1c336848cf925d43bb8eaf30487d0c87fa243f'
      ],
      [
        '8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047',
        '10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a'
      ],
      [
        '33b35baa195e729dc350f319996950df3bc15b8d3d0389e777d2808bf13f0351',
        'a58a0185640abf87f9464036248d52bcaa6560efbc889b702bc503cccb8d7418'
      ],
      [
        '374deeae22c93f955cb83ad2071f7e2256f6e109cad7bca6d71dc7b24414bb36',
        '171165b64fcd4f9916032c06f806f7293828d66300e543217875bea98daf734a'
      ],
      [
        '2380c09c7f3aeae57c46e07395aeb0dc944dbaf2b62a9f0c5e8a64ad6ae7d616',
        '6f8e86193464956af1598aefd509b09a93af92148f8467560099be48161bbc1a'
      ],
      [
        '385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862',
        '283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453'
      ],
      [
        'f6f622083daf54800456be134d5f67d147c82642befc1ce2dc83a27078f2827c',
        '1bcd4e817de73a0faf2c5715b367cee7e657ca7448321bf6d15b20b520aaa102'
      ],
      [
        'fb26e5188f953de2bd70cb3c3d1fc255cd91c3ce7d8c6f369d893209715adcb6',
        'f3e128811012a34d58e846a719d0176916d2cb31b8b7ab5449dbca3b58ba68f3'
      ],
      [
        '8991225911b9132d28f5c6bc763ceab7d18c37060e8bd1d7ed44db7560788c1e',
        'da8b4d987cc9ac9b27b8763559b136fa36969c84fdef9e11635c42228e8f0ef1'
      ],
      [
        '6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7',
        '7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160'
      ],
      [
        'ae86eeea252b411c1cdc36c284482939da1745e5a7e4da175c9d22744b7fd72d',
        '19e993c9707302f962ab0ace589ff0e98d9211551472f7282334cb7a4eee38bc'
      ],
      [
        '2248c9f90bbfff55e61d2f8c56dc2c488718be75cf36f2ee7a1474267c169290',
        'fa0594692d21eed7a506bb55b435ba18e163750235da2be2369d8a12883ea257'
      ],
      [
        'e11a6e16e05c44074ac11b48d94085d0a99f0877dd1c6f76fd0dac4bb50964e3',
        '87d6065b87a2d430e1ad5e2596f0af2417adc6e138318c6f767fbf8b0682bfc8'
      ],
      [
        '3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd',
        '56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0'
      ],
      [
        '8d26200250cebdae120ef31b04c80cd50d4cddc8eadbcf29fc696d32c0ade462',
        'ebed3bb4715bf437d31f6f2dc3ee36ba1d4afb4e72678b3ad8e0a8b90f26470c'
      ],
      [
        '1238c0766eaebea9ce4068a1f594d03b8ed4930d072d9c8b9164643e1516e633',
        '8a9db02dbb271359d6c979e2d1c3dc170946252dcc74022805cdb728c77b7805'
      ],
      [
        '271d5b0770cb9c15e7b2ea758a6a11b9cddcd7282b0ec21619b01552788e7a66',
        '5d3aa45834e7f491e457d09949ac877fe2a065e3508a824e7a8d7258e03c9727'
      ],
      [
        '85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83',
        '7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6'
      ],
      [
        '534ccf6b740f9ec036c1861215c8a61f3b89ea46df2e6d96998b90bc1f17fc25',
        'd5715cb09c8b2ddb462ae3dd32d543550ae3d277bfdd28ddd71c7f6ecfe86e76'
      ],
      [
        'a91d1f5cee87b7f3081e142018f8aaed79020d47ecfbc8d2c7170923e8bee8b6',
        '748a324ee2df8ee15a7189c8dddad3b2f800569f628cb225003d16aa410644c1'
      ],
      [
        'c15c8c23d90c8e35c1a214dde2d4383c0735ae45bef61f10aa1a1c255984cf74',
        '2ba954d828522235c8dc6f45e25fd7ba47bf772d50b015a2c4a48cd839ccb000'
      ],
      [
        '948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a',
        '53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589'
      ],
      [
        '26952c7f372e59360d5ce4c66291f0b6ef16c1331e825e51396eb0457e8b000a',
        'f513ea4c5800a68862bc893d2d688422debe398f653d67318c3d401f05ef705a'
      ],
      [
        'c62e58e6fc23c5bdbef2be8b131ff243f521196572d6b0e9f102588976134f96',
        '4397827d45b1a1678c3d676753141fc5bcfb853563731c3e82277ed4d14cf97e'
      ],
      [
        '107460520eec5c741683329a716622b0b81c03200807de973686f8800b188cbb',
        'abe5d4c09a21598c35326b9b9cf54a11242e0d748dce3da601d7b6361f272124'
      ],
      [
        '6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8',
        'bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17'
      ],
      [
        '85d8da4748ad1a73dec8409be84f1a1316e65c5196aad27e0766746f3d477c2d',
        '58948b53665c6690586b536531efc7bc94b0a02033c4d5a62079816fc7d1dd70'
      ],
      [
        '8e2a7166e7ec4b968c0892e9cc3ee3ee4d1e7e100fdc47f04850312d6c0b80d9',
        'eadb0ba9ae2cbe592cedd29b716a9d485297b688d706349a49c61f2ad6b29f50'
      ],
      [
        '769bc75842bff58edc8366ecd78f8950ee4ab2e81359d90f9921fa3d2c4561be',
        '4bf817362fe783bac8dce4cef73f5d4741a177767b7873add5920bffb0d9685f'
      ],
      [
        'e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d',
        '4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda'
      ],
      [
        'a5e00da467fd5494f40b6cf7d2d61b3ec3ab217c792a2ddb8c63c8c79e3d34ef',
        '98fe5f5e5608555421726fe99bf43d25b60dcfe790900acb855c5ce2f7adb4c'
      ],
      [
        'a99415f5ef3a2b403519f4bb1c9bfbc46d4afd2e4477572ae6737160d7b91252',
        '82d0e64cae81f84bb9e2f10f24f6f6b6899a16ad590f4ddd73a377ac4bedc264'
      ],
      [
        'b56f4e9f9e4fd1fc7d8edde098f935f84c750d705f0c132bd8c465b66a540f17',
        '32e8e53429cca856d3dc11adf0582d1d21d42963cbcca85446a2fcae0200102d'
      ],
      [
        'e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725',
        '7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd'
      ],
      [
        'eac134ca2046b8f9c8dbd304fad3f3c045ebfdb4ec6ed3cfe09aee43ed2ff3e',
        '49630dbe79359b4245bf103bf2b11799ac19f696b7f21376e17206207d210988'
      ],
      [
        'd6788590731fea198392119d7adbb41ff5948a7804c85b17476706e4dfbfa4dc',
        '28eaa8c89d5063c4940ef5c6d21c13aa6206f1c4ddc9a07cca7bcd6bbd3b5406'
      ],
      [
        '6930fccbd9a040974abf210f12b71d4bc7b1a6205599b01a7275fb40e48ff9b3',
        '7f02ae94b94701eada30fcdb875f6d78090f9b13e4acc51acfddab5f8ee96a4e'
      ],
      [
        '213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754',
        '4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2'
      ],
      [
        '1c5e548132b49a7f66ae9fed8323480e0d1ab974622e7cf08993895e0ec87fac',
        '4ffcf60f837f468f2bb959fa1d4c2ad3a3deaceb26fe324c555d7b3d5fc2d4ef'
      ],
      [
        '46276d0602c5668ddef6e94210bbc7ce1f901c19fed5c970e20fcba1d4531dbc',
        'e0f7f24d44c75b84a292287570ded99498badfbffe1bc99af8730099686b8e2'
      ],
      [
        'efea68eca7a6c24f4e65eb211c3191636850e0acdc78d8996114ef13522f001d',
        'aab847869d583c14da150307a3719a17e413959fb3848771c128419f73bc4415'
      ],
      [
        '4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c',
        '17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6'
      ],
      [
        '899017b02696888f268a269f4e385d9c9b11f25a1bef8790e2821e6e7c6e1b4d',
        '43ae2cdab5b334f0bb45798336358bfae4e51bc0f932b212009aebdad814ab2b'
      ],
      [
        '67f644f76e905fd4a8f4728e63227f0e2831f5bf91b583a8af2635a17e5f712f',
        'b833d68f66445d04f05adeb7b586cf785e0e1488f7d36198d68acb5e707160e5'
      ],
      [
        '327f876c93652555fa80a054968b4712930dc93012ee6b8dc10263ed3b89a762',
        'b2d404eab3524026b09969255e1997b975535070febd7dfe9c9fd959b9203301'
      ],
      [
        'fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6',
        '6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f'
      ]
    ]
  ]
});
